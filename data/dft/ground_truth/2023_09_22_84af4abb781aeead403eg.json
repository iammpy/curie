{"code": "from ase import Atoms\nfrom ase.calculators.crystal import CRYSTAL\nfrom ase.optimize import BFGS\nfrom pydantic import BaseModel\n\nfrom annotations.models.CrystalParameters import CrystalParameters\nfrom annotations.models.StructureMetadata import StructureMetadata\n\n# Functions Code\n\n\n\ndef crystal14_geometric_relaxation(\n    atoms: Atoms, parameters: CrystalParameters\n) -> Atoms:\n    crystal_keys = [\n        \"restart\",\n        \"xc\",\n        \"spinpol\",\n        \"guess\",\n        \"basis\",\n        \"kpts\",\n        \"isp\",\n        \"smearing\",\n    ]\n    parameter_dict = {\n        k: v for k, v in parameters.dict(exclude_none=True).items() if k in crystal_keys\n    }\n    calc = CRYSTAL(**parameter_dict)\n    atoms.set_calculator(calc)\n    dyn = BFGS(atoms)\n    dyn.run(parameters.fmax)\n    return atoms\n\n\ndef structure_generation_1_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(\n    metadata: StructureMetadata,\n) -> Atoms:\n    pass\n\n\ndef structure_generation_2_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(\n    metadata: StructureMetadata,\n) -> Atoms:\n    pass\n\n\n# Inputs Code\n\n\n\nclass CrystalParameters(BaseModel):\n    version: bool | None = None\n    restart: bool | None = None\n    xc: str | None = None\n    spinpol: bool | None = None\n    guess: bool | None = None\n    basis: str | None = None\n    kpts: str | list[int] | None = None\n    isp: int | None = None\n    smearing: float | None = None\n    fmax: float | None = 1e-5\n\n    class Config:\n        extra = \"allow\"\n\n\n\nclass StructureMetadata(BaseModel):\n    id: str | None = None\n    name: str | None = None\n    type: str | None = None\n    composition: str | None = None\n    description: str | None = None\n    vacuum_x: float | None = None\n    vacuum_y: float | None = None\n    vacuum_z: float | None = None\n    supercell: str | None = None\n    cas_number: str | None = None\n    orientation: str | None = None\n    lattice_a: float | None = None\n    lattice_b: float | None = None\n    lattice_c: float | None = None\n    orientation: str | None = None\n    mp_id: str | None = None\n\nstructure_metadata_na2h_citrate = StructureMetadata.parse_raw('{\"name\": \"Disodium hydrogen citrate\", \"type\": \"molecular\", \"composition\": \"Na2HC6H5O7(H2O)\", \"description\": \"crystal lattice\", \"vacuum_x\": NaN, \"vacuum_y\": NaN, \"vacuum_z\": NaN, \"supercell\": \"1x1x1\", \"cas_number\": NaN, \"lattice_a\": 16.9976, \"lattice_b\": 8.627, \"lattice_c\": 12.2926, \"space group\": \"Pbca\", \"orientation\": NaN, \"mp_id\": NaN}')\n\ncrystal14_parameters_2 = CrystalParameters.parse_raw('{\"version\": 14, \"restart\": NaN, \"xc\": \"B3LYP\", \"spinpol\": NaN, \"guess\": NaN, \"basis\": \"POB-TZVP \", \"kpts\": \"[8,8,8]\", \"isp\": NaN, \"smearing\": NaN, \"tolinteg\": NaN, \"toldee\": NaN, \"fmax\": NaN, \"Rb_basis\": NaN}')\n\n# Execution Code\n\nstructure_1 = structure_generation_1_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(structure_metadata_na2h_citrate)\nstructure_2 = structure_generation_2_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(structure_metadata_na2h_citrate)\nrelaxed_structure_1 = crystal14_geometric_relaxation(structure_1, crystal14_parameters_2)\nrelaxed_structure_2 = crystal14_geometric_relaxation(structure_2, crystal14_parameters_2)\n", "graph_as_text": "[{\"description\": \"returns the structure of disodium hydrogen citrate monohydrate according to this paper's XRD data\", \"function_id\": \"process_42\", \"function_name\": \"structure_generation_1_for_f88967c0d88127eaecd4b10a98d22df1f03719a6\", \"input_types\": [\"StructureMetadata\"], \"inputs\": [\"structure_metadata_na2h_citrate\"], \"output_types\": [\"Atoms\"], \"outputs\": [\"structure_1\"], \"process_type\": \"structure_generation\"}, {\"description\": \"returns the structure of diammonium citrate monohydrate according to this paper's XRD data\", \"function_id\": \"process_43\", \"function_name\": \"structure_generation_2_for_f88967c0d88127eaecd4b10a98d22df1f03719a6\", \"input_types\": [\"StructureMetadata\"], \"inputs\": [\"structure_metadata_na2h_citrate\"], \"output_types\": [\"Atoms\"], \"outputs\": [\"structure_2\"], \"process_type\": \"structure_generation\"}, {\"description\": \"runs a dft geometric relaxation using ase and CRYSTAL14 and returns the atoms object from the import parameters specified in a pydantic basemodel called Crystal14Parameters and an input ase atoms object\", \"function_id\": \"process_44\", \"function_name\": \"crystal14_geometric_relaxation\", \"input_types\": [\"Atoms\", \"CrystalParameters\"], \"inputs\": [\"structure_1\", \"crystal14_parameters_2\"], \"output_types\": [\"Atoms\"], \"outputs\": [\"relaxed_structure_1\"], \"process_type\": \"dft\"}, {\"description\": \"runs a dft geometric relaxation using ase and CRYSTAL14 and returns the atoms object from the import parameters specified in a pydantic basemodel called Crystal14Parameters and an input ase atoms object\", \"function_id\": \"process_45\", \"function_name\": \"crystal14_geometric_relaxation\", \"input_types\": [\"Atoms\", \"CrystalParameters\"], \"inputs\": [\"structure_2\", \"crystal14_parameters_2\"], \"output_types\": [\"Atoms\"], \"outputs\": [\"relaxed_structure_2\"], \"process_type\": \"dft\"}]", "no_header_code": "from ase import Atoms\nfrom ase.calculators.crystal import CRYSTAL\nfrom ase.optimize import BFGS\nfrom pydantic import BaseModel\n\nfrom annotations.models.CrystalParameters import CrystalParameters\nfrom annotations.models.StructureMetadata import StructureMetadata\n\n# Functions Code\n\n\n\ndef structure_generation_2_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(\n    metadata: StructureMetadata,\n) -> Atoms:\n    pass\n\n\ndef structure_generation_1_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(\n    metadata: StructureMetadata,\n) -> Atoms:\n    pass\n\n\ndef crystal14_geometric_relaxation(\n    atoms: Atoms, parameters: CrystalParameters\n) -> Atoms:\n    crystal_keys = [\n        \"restart\",\n        \"xc\",\n        \"spinpol\",\n        \"guess\",\n        \"basis\",\n        \"kpts\",\n        \"isp\",\n        \"smearing\",\n    ]\n    parameter_dict = {\n        k: v for k, v in parameters.dict(exclude_none=True).items() if k in crystal_keys\n    }\n    calc = CRYSTAL(**parameter_dict)\n    atoms.set_calculator(calc)\n    dyn = BFGS(atoms)\n    dyn.run(parameters.fmax)\n    return atoms\n\n\n# Inputs Code\n\n\n\nclass StructureMetadata(BaseModel):\n    id: str | None = None\n    name: str | None = None\n    type: str | None = None\n    composition: str | None = None\n    description: str | None = None\n    vacuum_x: float | None = None\n    vacuum_y: float | None = None\n    vacuum_z: float | None = None\n    supercell: str | None = None\n    cas_number: str | None = None\n    orientation: str | None = None\n    lattice_a: float | None = None\n    lattice_b: float | None = None\n    lattice_c: float | None = None\n    orientation: str | None = None\n    mp_id: str | None = None\n\n\n\nclass CrystalParameters(BaseModel):\n    version: bool | None = None\n    restart: bool | None = None\n    xc: str | None = None\n    spinpol: bool | None = None\n    guess: bool | None = None\n    basis: str | None = None\n    kpts: str | list[int] | None = None\n    isp: int | None = None\n    smearing: float | None = None\n    fmax: float | None = 1e-5\n\n    class Config:\n        extra = \"allow\"\n\nstructure_metadata_na2h_citrate = StructureMetadata.parse_raw('{\"name\": \"Disodium hydrogen citrate\", \"type\": \"molecular\", \"composition\": \"Na2HC6H5O7(H2O)\", \"description\": \"crystal lattice\", \"vacuum_x\": NaN, \"vacuum_y\": NaN, \"vacuum_z\": NaN, \"supercell\": \"1x1x1\", \"cas_number\": NaN, \"lattice_a\": 16.9976, \"lattice_b\": 8.627, \"lattice_c\": 12.2926, \"space group\": \"Pbca\", \"orientation\": NaN, \"mp_id\": NaN}')\n\ncrystal14_parameters_2 = CrystalParameters.parse_raw('{\"version\": 14, \"restart\": NaN, \"xc\": \"B3LYP\", \"spinpol\": NaN, \"guess\": NaN, \"basis\": \"POB-TZVP \", \"kpts\": \"[8,8,8]\", \"isp\": NaN, \"smearing\": NaN, \"tolinteg\": NaN, \"toldee\": NaN, \"fmax\": NaN, \"Rb_basis\": NaN}')\n\n# Execution Code\n\nstructure_1 = structure_generation_1_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(structure_metadata_na2h_citrate)\nstructure_2 = structure_generation_2_for_f88967c0d88127eaecd4b10a98d22df1f03719a6(structure_metadata_na2h_citrate)\nrelaxed_structure_1 = crystal14_geometric_relaxation(structure_1, crystal14_parameters_2)\nrelaxed_structure_2 = crystal14_geometric_relaxation(structure_2, crystal14_parameters_2)\n", "record_id": "2023_09_22_84af4abb781aeead403eg"}